{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/juant/Documents/proyectoCUN/aulaunida/src/hooks/useUserRole.ts"],"sourcesContent":["\"use client\";\r\nimport { useEffect, useState } from 'react';\r\nimport { useAuth } from '../context/authContext';\r\n\r\n// Hook para obtener el rol del usuario desde la API interna (PostgreSQL)\r\nexport function useUserRole() {\r\n  const { user } = useAuth();\r\n  const [role, setRole] = useState<string | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    if (!user) {\r\n      setRole(null);\r\n      setLoading(false);\r\n      return;\r\n    }\r\n    // Llama a tu API interna para obtener el rol por UID de Firebase\r\n    const fetchRole = async () => {\r\n      setLoading(true);\r\n      try {\r\n        const res = await fetch(`/api/user-role?uid=${user.uid}`);\r\n        const data = await res.json();\r\n        setRole(data.role || null);\r\n      } catch (err) {\r\n        setRole(null);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n    fetchRole();\r\n  }, [user]);\r\n\r\n  return { role, loading };\r\n}\r\n"],"names":[],"mappings":";;;;AACA;AACA;AAFA;;;AAKO,SAAS;IACd,MAAM,EAAE,IAAI,EAAE,GAAG,IAAA,yIAAO;IACxB,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAgB;IAChD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IAEvC,IAAA,kNAAS,EAAC;QACR,IAAI,CAAC,MAAM;YACT,QAAQ;YACR,WAAW;YACX;QACF;QACA,iEAAiE;QACjE,MAAM,YAAY;YAChB,WAAW;YACX,IAAI;gBACF,MAAM,MAAM,MAAM,MAAM,CAAC,mBAAmB,EAAE,KAAK,GAAG,EAAE;gBACxD,MAAM,OAAO,MAAM,IAAI,IAAI;gBAC3B,QAAQ,KAAK,IAAI,IAAI;YACvB,EAAE,OAAO,KAAK;gBACZ,QAAQ;YACV,SAAU;gBACR,WAAW;YACb;QACF;QACA;IACF,GAAG;QAAC;KAAK;IAET,OAAO;QAAE;QAAM;IAAQ;AACzB","debugId":null}},
    {"offset": {"line": 49, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/juant/Documents/proyectoCUN/aulaunida/src/components/ProtectedRoute.tsx"],"sourcesContent":["\"use client\";\r\nimport React from 'react';\r\nimport { useAuth } from '../context/authContext';\r\nimport { useUserRole } from '../hooks/useUserRole';\r\n\r\n// Componente para proteger rutas según autenticación y rol\r\nexport default function ProtectedRoute({ children, allowedRoles }: { children: React.ReactNode, allowedRoles?: string[] }) {\r\n  const { user, loading: authLoading } = useAuth();\r\n  const { role, loading: roleLoading } = useUserRole();\r\n\r\n  if (authLoading || roleLoading) return <div>Cargando...</div>;\r\n  if (!user) {\r\n    if (typeof window !== 'undefined') {\r\n      window.location.href = '/login';\r\n    }\r\n    return null;\r\n  }\r\n\r\n  if (allowedRoles && (!role || !allowedRoles.includes(role))) {\r\n    return <div>No tienes permiso para acceder a esta página.</div>;\r\n  }\r\n\r\n  return <>{children}</>;\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAHA;;;;AAMe,SAAS,eAAe,EAAE,QAAQ,EAAE,YAAY,EAA0D;IACvH,MAAM,EAAE,IAAI,EAAE,SAAS,WAAW,EAAE,GAAG,IAAA,yIAAO;IAC9C,MAAM,EAAE,IAAI,EAAE,SAAS,WAAW,EAAE,GAAG,IAAA,0IAAW;IAElD,IAAI,eAAe,aAAa,qBAAO,8OAAC;kBAAI;;;;;;IAC5C,IAAI,CAAC,MAAM;QACT;;QAGA,OAAO;IACT;IAEA,IAAI,gBAAgB,CAAC,CAAC,QAAQ,CAAC,aAAa,QAAQ,CAAC,KAAK,GAAG;QAC3D,qBAAO,8OAAC;sBAAI;;;;;;IACd;IAEA,qBAAO;kBAAG;;AACZ","debugId":null}},
    {"offset": {"line": 110, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/juant/Documents/proyectoCUN/aulaunida/src/components/NextLink.tsx"],"sourcesContent":["import Link from 'next/link';\r\n\r\nexport default Link;"],"names":[],"mappings":";;;;AAAA;;uCAEe,uKAAI","debugId":null}},
    {"offset": {"line": 120, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/styles/admin-dashboard.module.css [app-ssr] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"activityAction\": \"admin-dashboard-module__5BnUYq__activityAction\",\n  \"activityCard\": \"admin-dashboard-module__5BnUYq__activityCard\",\n  \"activityDate\": \"admin-dashboard-module__5BnUYq__activityDate\",\n  \"activityTable\": \"admin-dashboard-module__5BnUYq__activityTable\",\n  \"activityTitle\": \"admin-dashboard-module__5BnUYq__activityTitle\",\n  \"activityUser\": \"admin-dashboard-module__5BnUYq__activityUser\",\n  \"avatar\": \"admin-dashboard-module__5BnUYq__avatar\",\n  \"dashboardContainer\": \"admin-dashboard-module__5BnUYq__dashboardContainer\",\n  \"logo\": \"admin-dashboard-module__5BnUYq__logo\",\n  \"logoutBtn\": \"admin-dashboard-module__5BnUYq__logoutBtn\",\n  \"mainContent\": \"admin-dashboard-module__5BnUYq__mainContent\",\n  \"menu\": \"admin-dashboard-module__5BnUYq__menu\",\n  \"menuItem\": \"admin-dashboard-module__5BnUYq__menuItem\",\n  \"menuItemActive\": \"admin-dashboard-module__5BnUYq__menuItemActive\",\n  \"metricCard\": \"admin-dashboard-module__5BnUYq__metricCard\",\n  \"metricLabel\": \"admin-dashboard-module__5BnUYq__metricLabel\",\n  \"metricValue\": \"admin-dashboard-module__5BnUYq__metricValue\",\n  \"metricsGrid\": \"admin-dashboard-module__5BnUYq__metricsGrid\",\n  \"sidebar\": \"admin-dashboard-module__5BnUYq__sidebar\",\n  \"subtitle\": \"admin-dashboard-module__5BnUYq__subtitle\",\n  \"title\": \"admin-dashboard-module__5BnUYq__title\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 147, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/juant/Documents/proyectoCUN/aulaunida/src/app/admin/page.tsx"],"sourcesContent":["\"use client\";\r\nimport ProtectedRoute from '../../components/ProtectedRoute';\r\nimport { useAuth } from '../../context/authContext';\r\nimport { UserCircleIcon, BookOpenIcon, CalendarIcon, UsersIcon, ClipboardIcon, AcademicCapIcon, ChartBarIcon, MegaphoneIcon, Cog6ToothIcon, QuestionMarkCircleIcon } from '@heroicons/react/24/outline';\r\nimport NextLink from '../../components/NextLink';\r\nimport { useEffect, useState } from 'react';\r\nimport styles from '../../styles/admin-dashboard.module.css';\r\n\r\nconst metricsLabels = [\r\n  { label: 'Usuarios Activos', key: 'usuariosActivos' },\r\n  { label: 'Grados Registrados', key: 'gradosRegistrados' },\r\n  { label: 'Anuncios Recientes', key: 'anunciosRecientes' },\r\n];\r\n\r\nconst sidebarLinks = [\r\n  { label: 'Gestión de Usuarios', icon: UsersIcon, href: '/admin/usuarios' },\r\n  { label: 'Grados/Secciones', icon: AcademicCapIcon, href: '/admin/grados' },\r\n  { label: 'Asignaturas', icon: BookOpenIcon, href: '/admin/asignaturas' },\r\n  { label: 'Horarios', icon: CalendarIcon, href: '/admin/horarios' },\r\n  { label: 'Matrícula', icon: ClipboardIcon, href: '/admin/matricula' },\r\n  { label: 'Ciclos Lectivos', icon: CalendarIcon, href: '/admin/ciclos' },\r\n  { label: 'Reportes', icon: ChartBarIcon, href: '/admin/reportes' },\r\n  { label: 'Anuncios', icon: MegaphoneIcon, href: '/admin/anuncios' },\r\n  { label: 'Configuración', icon: Cog6ToothIcon, href: '/admin/configuracion' },\r\n  { label: 'Ayuda/FAQs', icon: QuestionMarkCircleIcon, href: '/admin/faqs' },\r\n    { label: 'Crear Usuario', icon: UserCircleIcon, href: '/admin/usuarios' },\r\n    { label: 'Listado de usuarios', icon: UserCircleIcon, href: '/admin/usuarios/listado' },\r\n];\r\n\r\nexport default function AdminDashboardPage() {\r\n  const { logout } = useAuth();\r\n  const [metrics, setMetrics] = useState<any>(null);\r\n  const [activity, setActivity] = useState<any[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    setLoading(true);\r\n    fetch('/api/admin/dashboard')\r\n      .then(res => res.json())\r\n      .then(data => {\r\n        setMetrics(data);\r\n        setActivity(data.actividad || []);\r\n        setLoading(false);\r\n      })\r\n      .catch(() => setLoading(false));\r\n  }, []);\r\n\r\n  return (\r\n    <ProtectedRoute allowedRoles={[\"ADMIN\"]}>\r\n  <div className={styles.dashboardContainer}>\r\n        {/* Sidebar */}\r\n        <aside className={styles.sidebar}>\r\n          <div style={{ display: 'flex', alignItems: 'center', marginBottom: '3rem' }}>\r\n            <img src=\"https://randomuser.me/api/portraits/women/44.jpg\" alt=\"Admin\" className={styles.avatar} />\r\n            <span className={styles.logo}>AulaUnida</span>\r\n          </div>\r\n          <nav className={styles.menu}>\r\n            <ul style={{ listStyle: 'none', padding: 0, margin: 0 }}>\r\n              {sidebarLinks.map((link, idx) => (\r\n                <li key={link.label}>\r\n                  <NextLink href={link.href} className={styles.menuItem}>\r\n                    <link.icon style={{ width: 24, height: 24, marginRight: 16 }} />\r\n                    {link.label}\r\n                  </NextLink>\r\n                </li>\r\n              ))}\r\n            </ul>\r\n          </nav>\r\n          <button onClick={logout} className={styles.logoutBtn}><span style={{ marginRight: 8 }}>⎋</span> Cerrar sesión</button>\r\n        </aside>\r\n\r\n        {/* Main content */}\r\n        <main className={styles.mainContent}>\r\n          <h1 className={styles.title}>Panel de Administrador</h1>\r\n          <p className={styles.subtitle}>Bienvenido, aquí tienes un resumen del estado del sistema.</p>\r\n\r\n          {/* Loader y datos reales */}\r\n          {loading ? (\r\n            <div style={{ display: 'flex', justifyContent: 'center', alignItems: 'center', height: '10rem' }}>\r\n              <span style={{ color: '#B0B3B8', fontSize: '1.125rem' }}>Cargando datos...</span>\r\n            </div>\r\n          ) : (\r\n            <>\r\n              {/* Métricas */}\r\n              <div className={styles.metricsGrid}>\r\n                {metricsLabels.map((m) => (\r\n                  <div key={m.label} className={styles.metricCard}>\r\n                    <span className={styles.metricLabel}>{m.label}</span>\r\n                    <span className={styles.metricValue}>{metrics ? metrics[m.key] : '-'}</span>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n\r\n              {/* Actividad reciente */}\r\n              <div className={styles.activityCard}>\r\n                <h2 className={styles.activityTitle}>Actividad Reciente</h2>\r\n                <div style={{ overflowX: 'auto' }}>\r\n                  <table className={styles.activityTable}>\r\n                    <thead>\r\n                      <tr>\r\n                        <th>USUARIO</th>\r\n                        <th>ACCIÓN</th>\r\n                        <th>FECHA</th>\r\n                      </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                      {activity.length === 0 ? (\r\n                        <tr><td colSpan={3} style={{ padding: '2rem', textAlign: 'center', color: '#B0B3B8' }}>Sin actividad reciente</td></tr>\r\n                      ) : (\r\n                        activity.map((a, idx) => (\r\n                          <tr key={idx}>\r\n                            <td className={styles.activityUser}>{a.user}</td>\r\n                            <td className={styles.activityAction}>{a.action}</td>\r\n                            <td className={styles.activityDate}>{a.date}</td>\r\n                          </tr>\r\n                        ))\r\n                      )}\r\n                    </tbody>\r\n                  </table>\r\n                </div>\r\n              </div>\r\n            </>\r\n          )}\r\n        </main>\r\n      </div>\r\n    </ProtectedRoute>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}