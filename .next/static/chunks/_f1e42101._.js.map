{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///app/src/hooks/useUserRole.ts"],"sourcesContent":["\"use client\";\r\nimport { useEffect, useState } from 'react';\r\nimport { useAuth } from '../context/authContext';\r\n\r\n// Hook para obtener el rol del usuario desde la API interna (PostgreSQL)\r\nexport function useUserRole() {\r\n  const { user } = useAuth();\r\n  const [role, setRole] = useState<string | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  useEffect(() => {\r\n    if (!user) {\r\n      setRole(null);\r\n      setLoading(false);\r\n      return;\r\n    }\r\n    // Llama a tu API interna para obtener el rol por UID de Firebase\r\n    const fetchRole = async () => {\r\n      setLoading(true);\r\n      try {\r\n        const res = await fetch(`/api/user-role?uid=${user.uid}`);\r\n        const data = await res.json();\r\n        setRole(data.role || null);\r\n      } catch (err) {\r\n        setRole(null);\r\n      } finally {\r\n        setLoading(false);\r\n      }\r\n    };\r\n    fetchRole();\r\n  }, [user]);\r\n\r\n  return { role, loading };\r\n}\r\n"],"names":[],"mappings":";;;;AACA;AACA;;AAFA;;;AAKO,SAAS;;IACd,MAAM,EAAE,IAAI,EAAE,GAAG,IAAA,4IAAO;IACxB,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,yKAAQ,EAAgB;IAChD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IAEvC,IAAA,0KAAS;iCAAC;YACR,IAAI,CAAC,MAAM;gBACT,QAAQ;gBACR,WAAW;gBACX;YACF;YACA,iEAAiE;YACjE,MAAM;mDAAY;oBAChB,WAAW;oBACX,IAAI;wBACF,MAAM,MAAM,MAAM,MAAM,AAAC,sBAA8B,OAAT,KAAK,GAAG;wBACtD,MAAM,OAAO,MAAM,IAAI,IAAI;wBAC3B,QAAQ,KAAK,IAAI,IAAI;oBACvB,EAAE,OAAO,KAAK;wBACZ,QAAQ;oBACV,SAAU;wBACR,WAAW;oBACb;gBACF;;YACA;QACF;gCAAG;QAAC;KAAK;IAET,OAAO;QAAE;QAAM;IAAQ;AACzB;GA5BgB;;QACG,4IAAO","debugId":null}},
    {"offset": {"line": 62, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/styles/login.module.css [app-client] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"login-bg\": \"login-module__4pxX9G__login-bg\",\n  \"login-card\": \"login-module__4pxX9G__login-card\",\n  \"login-center\": \"login-module__4pxX9G__login-center\",\n  \"login-error\": \"login-module__4pxX9G__login-error\",\n  \"login-form\": \"login-module__4pxX9G__login-form\",\n  \"login-header\": \"login-module__4pxX9G__login-header\",\n  \"login-title\": \"login-module__4pxX9G__login-title\",\n  \"logo\": \"login-module__4pxX9G__logo\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 76, "column": 0}, "map": {"version":3,"sources":["file:///app/src/app/login/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { useState, useEffect } from \"react\";\r\nimport { getAuth, signInWithEmailAndPassword } from \"firebase/auth\";\r\nimport { app } from \"../../lib/firebaseClient\";\r\nimport { useAuth } from \"../../context/authContext\";\r\nimport { useUserRole } from \"../../hooks/useUserRole\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport styles from \"../../styles/login.module.css\";\r\n\r\nexport default function LoginPage() {\r\n  const [email, setEmail] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [error, setError] = useState(\"\");\r\n  const { user, loading, logout } = useAuth();\r\n  const { role, loading: roleLoading } = useUserRole();\r\n  const router = useRouter();\r\n\r\n\r\n  // Si el usuario ya está autenticado y tiene rol, redirige automáticamente\r\n  useEffect(() => {\r\n    if (user && !loading && role && !roleLoading) {\r\n      if (role === 'ADMIN' || role === 'admin') router.replace('/admin');\r\n      else if (role === 'DOCENTE' || role === 'docente') router.replace('/docente');\r\n      else if (role === 'STUDENT' || role === 'estudiante') router.replace('/estudiante');\r\n    }\r\n  }, [user, loading, role, roleLoading, router]);\r\n\r\n  // (La redirección ya está incluida arriba)\r\n\r\n  const handleSubmit = async (e: React.FormEvent) => {\r\n    e.preventDefault();\r\n    setError(\"\");\r\n    try {\r\n      const auth = getAuth(app);\r\n      await signInWithEmailAndPassword(auth, email, password);\r\n      // El useEffect se encargará de redirigir\r\n    } catch (err: any) {\r\n      setError(err.message || \"Error al iniciar sesión\");\r\n    }\r\n  };\r\n\r\n\r\n  // Mostrar loading si está cargando la sesión\r\n  if (loading || roleLoading) {\r\n    return <div className={styles[\"login-bg\"]}>Cargando...</div>;\r\n  }\r\n  // Si ya hay usuario y rol, mostrar mensaje de redirección\r\n  if (user && role) {\r\n    return <div className={styles[\"login-bg\"]}>Redirigiendo...</div>;\r\n  }\r\n\r\n  return (\r\n    <div className={styles[\"login-bg\"]}>\r\n      <header className={styles[\"login-header\"]}>\r\n        <span className={styles.logo}></span>\r\n        AulaUnida\r\n      </header>\r\n      <div className={styles[\"login-center\"]}>\r\n        <div className={styles[\"login-card\"]}>\r\n          <div className={styles[\"login-title\"]}>Bienvenido a AulaUnida</div>\r\n          <form onSubmit={handleSubmit} className={styles[\"login-form\"]}>\r\n            <input\r\n              type=\"email\"\r\n              placeholder=\"Usuario\"\r\n              value={email}\r\n              onChange={e => setEmail(e.target.value)}\r\n              required\r\n              autoComplete=\"username\"\r\n            />\r\n            <input\r\n              type=\"password\"\r\n              placeholder=\"Contraseña\"\r\n              value={password}\r\n              onChange={e => setPassword(e.target.value)}\r\n              required\r\n              autoComplete=\"current-password\"\r\n            />\r\n            <button type=\"submit\">Ingresar</button>\r\n            {error && <div className={styles[\"login-error\"]}>{error}</div>}\r\n          </form>\r\n          {/* Botón para volver a la página principal */}\r\n          <button\r\n            type=\"button\"\r\n            className={styles[\"login-back-btn\"]}\r\n            onClick={() => router.push(\"/\")}\r\n            style={{ marginTop: \"1.5rem\", background: \"none\", color: \"#fff\", border: \"1px solid #fff\", borderRadius: \"6px\", padding: \"0.5rem 1.2rem\", cursor: \"pointer\", fontSize: \"1rem\", transition: \"background 0.2s, color 0.2s\" }}\r\n            onMouseOver={e => { (e.target as HTMLButtonElement).style.background = \"#fff\"; (e.target as HTMLButtonElement).style.color = \"#222\"; }}\r\n            onMouseOut={e => { (e.target as HTMLButtonElement).style.background = \"none\"; (e.target as HTMLButtonElement).style.color = \"#fff\"; }}\r\n          >\r\n            Volver a la página principal\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 303, "column": 0}, "map": {"version":3,"sources":["file:///app/node_modules/next/navigation.js"],"sourcesContent":["module.exports = require('./dist/client/components/navigation')\n"],"names":[],"mappings":"AAAA,OAAO,OAAO","ignoreList":[0],"debugId":null}}]
}